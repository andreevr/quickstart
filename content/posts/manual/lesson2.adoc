---
title: "Урок 2. Знакомство с кнопкой"
date: 2018-06-08T11:34:59+03:00
---

В данном уроке ты научишься использовать кнопку для управления светодиодом.<!--more-->

TIP: Кнопка - это простой механизм, замыкающий цепь. Пока кнопка нажата - цепь замкнута, кнопка опущена - цепь разомкнута.

.Внешний вид тактовой кнопки
image::pictures/2.1.button.jpg[300, 300]


.Обозначение кнопки на схеме (слева с одной парой контактов, справа с двумя парами контактов)
image::pictures/2.2.1.button.jpg[350, 350]

Рассмотрим схему, представленную ниже:

.Схема подключения кнопки через стягивающий резистор
image::pictures/2.2.2.button.jpg[300, 300]

В этой схеме сигнал идет с источника питания через кнопку и попадает в плату Arduino Nano черезе пин D12,
в дальнейшем микроконтроллер обрабатывает этот сигнал и посылает сигнал на пин D13,
к которому подключен светодиод. Резистор в схеме играет роль *стягивающего*, который забирает излишки тока в землю.
На нашей кросс-плате к кнопке уже подключен данный резистор. Его номинал составляет 10 кОм.

Реализуем данную схему в ходе работы.

=== Стягивающий  резистор
Используются в схемах, рядом с контактами логических компонентов, где важно только 2 факта:
есть на контакте питание или нет. Например контакты Arduino.
Задача этих резисторов - не оставить контакт компонента в "подвешенном" состоянии.

Рассмотрим схему без стягивающего резистора

.Схема подключения светодиода через кнопку
image::pictures/2.2.3.buttonNotRezistor.jpg[300, 300]

Мы хотим, чтобы когда кнопка была не нажата, светодиод не горел (цифровой вход фиксировал отсутствие сигнала).
Но в данном случае наш вход то срабатывает, то не срабатывает в хаотическом состоянии (Светодиод может тускло гореть).
Причина этого — шумы. Которые возникают из различных воздействий окружающей среды. Провода действуют как антенны и производят электричество из электромагнитных волн среды.
Чтобы гарантировать отсутствие напряжения при разомкнутой цепи, рядом со светодиодом (либо любым другим цифровым входом платы) ставится стягивающий резистор:

.Схема подключения светодиода через кнопку с использованием стягивающего резистора
image::pictures/2.2.4.buttonRezistor.jpg[300, 300]

Теперь нам не будут мешать шумы. При нажатии на кнопку светодиод будет гореть, а при не нажатии гарантированно погаснет.

TIP: Как правило сопротивление стягивающего резистора не менее 10 кОм.

=== Оператор if...else
Конструкция *if...else* позволяет в программе выполнять проверку условия
и задавать варианты дальнейшего ее решения.

Синтаксис этой конструкции таков:
....
if (условие)       // Проверяется указанное условие
{
  // Действие A
}
else                           // Иначе
{
  // Действие B
....

Если *условие* будет верным, то программы перейдет к *Действию A*, а *Действие B* проигнорирует.

Если условие - *неверное*, то программа будет выполнять *Действие B*, а *Действие A* - игнорировать.

=== Ход работы

1. Установи Arduino Nano на кросс-плату;
2. Подключи кнопку и светодиод, как показано на рисунке.
+
.Схема подключения кнопки и светодиода к плате
image::pictures/2.3.buttonLuminodeode.jpg[700, 700]

3. Подключи устройство к компьютеру через последовательный порт и загрузи на него код:
+
....
// Код для включения светодиода с помощью кнопки

int buttonPin = 12;           // Назначаем пин с кнопкой
int ledPin = 13;              // Назначаем пин со светодиодом
boolean buttonState = LOW;    // Состояние кнопки отжата

void setup()
{
  pinMode(buttonPin, INPUT); // Задаем пин с кнопкой как вход,
  pinMode(ledPin, OUTPUT);   // а пин со светодиодом - как выход
}

void loop()
{
  // Считываем значение кнопки
  buttonState = digitalRead(buttonPin);
  if (buttonState == HIGH)       // Если кнопка нажата
  {
    digitalWrite(ledPin, HIGH);  // Включаем светодиод
  }
  else                           // Иначе
  {
    digitalWrite(ledPin, LOW);   // Выключаем светодиод
  }
}
....

4. Теперь нажми и удерживай кнопку. Если ты все делал по указаниям, то при нажатии на кнопку светодиод должен загораться, а при отпускании кнопки - гаснуть.

Когда ты нажимаешь на кнопку, ты замыкаешь цепь и электрический ток поступает на пин D12, в дальнейшем наша программа обрабатывает этот сигнал и подает высокий уровень напряжения на пин D13, к которому подключен светодиод.

Давай рассмотрим нашу программу подробнее.

Часть функций ты видел в xref:Урок 1. Знакомство со светодиодом[уроке 1]

....
int buttonPin = 12;           // Назначаем пин с кнопкой
....

Данной строчкой мы создаем глобальную переменную с именем *buttonPin*, типа *int* (integer - целый тип данных) и присваиваем ей значение *12*.
Имя переменной может быть любым, но понятным для тебя. Значение должно соответствовать пину, который ты выбрал, а тип переменной мы выбрали целый по причине того, что пины на плате обозначаются целыми числами (12, 13, 14 и тп.), а не дробными (0,5, 0,8 и тп.).

TIP: В программе каждая переменная имеет имя, тип данных и значение.

TIP: *Глобальные переменные* - это переменные, которые доступны всей программе, включая подпрограммы (пользовательские функции). *Локальные переменные* - переменные, определенные внутри подпрограммы (пользовательской функции). Они доступны только внутри функции, в которой они определены.

....
boolean buttonState = LOW;    // Состояние кнопки отжата
....

Переменная *buttonState* необходима нам для того, чтобы отследить состояние нашей кнопки. У нее может быть 2 состояния: нажата и отжата.
Поэтому мы создаем переменную типа *boolean* c начальным значением *LOW* (в ходе программы это значение будет изменяться).

* *boolean* - тип данных, принимающий всего два возможных значения (true (истина) или false (ложь); 1 или 0; LOW (низкий уровень напряжения) или HIGH (высокий уровень напряжения))

....
pinMode(buttonPin, INPUT); // Задаем пин с кнопкой как вход
....

* *pinMode()* - это процедура, которая устанавливает определенный пин в соответствующий режим;
* *buttonPin* - имя пина, к которому подключен светодиод. В xref:Урок 1. Знакомство со светодиодом[уроке 1] мы не задавали имя пину, а писали просто номер пина. Правильнее задавать имя для всех переменных;
* *INPUT* - режим, в который мы устанавливаем наш пин. В нашем случае пин определен как *вход*. Это значит что информационный сигнал будет передаваться из вне на этот пин;

....
buttonState = digitalRead(buttonPin);
....

С помощью функции *digitalRead()*, программа считывает значение с переменной *buttonPin* и присваивает его нашей переменной *buttonState*.

* *digitalRead()* - функция, считывающая значение с указанного пина. Возвращает либо LOW, либо HIGH;

....
if (buttonState == HIGH)       // Если кнопка нажата
{
  digitalWrite(ledPin, HIGH);  // Включаем светодиод
}
else                           // Иначе
{
  digitalWrite(ledPin, LOW);   // Выключаем светодиод
}
....

В данном месте программы мы проверяем состояние кнопки: нажата или нет. Используем при этом конструкцию *if, else*

Молодец, теперь ты знаешь как с помощью кнопки замыкать и размыкать электрическую цепь.
Вместо светодиода могут быть подсоединены и другие устройства, например пищалка (пьезоэлемент).

=== Задания
1. Поправь программу так, чтобы при опущенной кнопке светодиод горел, а при нажатой нет.

2. Поправь программу так, чтобы при опущенной кнопке светодиод горел, а при нажатой мигал с периодичностью в 1 секунду.
(Смотри xref:Урок 1. Знакомство со светодиодом[урок 1]).

3. Поправь программу так, чтобы при нажатии на кнопку светодиод мигал, а при
отпущенной кнопке нет.

4. Подсоедини в схему вместо светодиода пищалку (пьезоэлемент).
Что произошло?